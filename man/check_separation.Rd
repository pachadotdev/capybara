% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/separation.R
\name{check_separation}
\alias{check_separation}
\title{Check for Statistical Separation in Poisson Models}
\usage{
check_separation(
  y,
  X = NULL,
  w = NULL,
  tol = 1e-08,
  zero_tol = 1e-12,
  max_iter = 1000L,
  simplex_max_iter = 10000L,
  use_relu = TRUE,
  use_simplex = TRUE,
  verbose = FALSE
)
}
\arguments{
\item{y}{Numeric vector of response values (non-negative integers for count data).}

\item{X}{Numeric matrix of regressors (design matrix). Can be \code{NULL} or
empty if only checking fixed effects separation.}

\item{w}{Numeric vector of weights. Default is a vector of ones.}

\item{tol}{Tolerance for convergence. Default is \code{1e-8}.}

\item{zero_tol}{Tolerance for treating values as zero. Default is \code{1e-12}.}

\item{max_iter}{Maximum iterations for ReLU method. Default is \code{1000L}.}

\item{simplex_max_iter}{Maximum iterations for simplex method. Default is \code{10000L}.}

\item{use_relu}{Logical, whether to use the ReLU method. Default is \code{TRUE}.}

\item{use_simplex}{Logical, whether to use the simplex method. Default is \code{TRUE}.}

\item{verbose}{Logical, whether to print progress information. Default is \code{FALSE}.}
}
\value{
A list with components:
\describe{
\item{separated_obs}{Integer vector of row indices (1-based) of separated observations.}
\item{num_separated}{Number of separated observations found.}
\item{converged}{Logical indicating if the algorithm converged.}
\item{iterations}{Number of iterations used (for ReLU method).}
\item{certificate}{Numeric vector giving the separation certificate (z vector), if computed by the ReLU method.}
}
}
\description{
Detect statistical separation (perfect predictors) in Poisson
regression models. Separation occurs when a linear combination of regressors
can perfectly predict zero outcomes, causing maximum likelihood estimates to
diverge. This function implements the ReLU and simplex methods from Correia,
Guimar達es, and Zylkin (2019).
}
\details{
Statistical separation occurs in Poisson and other count data models when
there exists a linear combination of regressors that is non-negative for all
observations with \eqn{y = 0} and positive for at least one such observation.
This causes the MLE to not exist (coefficients diverge to \eqn{\pm\infty}).

The function implements two complementary detection methods:

\strong{ReLU Method:} An iterative algorithm that solves a sequence of
constrained least squares problems using the Rectified Linear Unit (ReLU)
activation function. This method is more thorough and provides a certificate
of separation.

\strong{Simplex Method:} A linear programming approach that checks for
separating hyperplanes. This method is faster for initial screening.

Both methods are based on the theoretical framework of Correia, Guimar達es,
and Zylkin (2019), who show that separation detection is equivalent to
solving a specific linear programming problem.
}
\examples{
\dontrun{
# Example with separation
set.seed(123)
n <- 100
x <- rnorm(n)
# Create separation: y = 0 whenever x > 1
y <- rpois(n, exp(1 - x))
y[x > 1] <- 0

# Check for separation
result <- check_separation(y, matrix(x, ncol = 1))
print(result$num_separated)
}

}
\references{
Correia, S., Guimar達es, P., and Zylkin, T. (2019). "Verifying the Existence
of Maximum Likelihood Estimates for Generalized Linear Models."
\url{https://arxiv.org/abs/1903.01633}

Correia, S., Guimar達es, P., and Zylkin, T. (2020). "Fast Poisson Estimation
with High-Dimensional Fixed Effects." \emph{The Stata Journal}, 20(1), 95-115.
}
\seealso{
\code{\link{fepoisson}}, \code{\link{feglm}}
}
