<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Asymptotic bias correction after fitting binary choice models with a
 1,2,3-way error component — bias_corr • capybara</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Asymptotic bias correction after fitting binary choice models with a
 1,2,3-way error component — bias_corr"><meta property="og:description" content="Post-estimation routine to substantially reduce the incidental
 parameter bias problem. Applies the analytical bias correction derived by
 Fernández-Val and Weidner (2016) and Hinz, Stammann, and Wanner (2020) to
 obtain bias-corrected estimates of the structural parameters and is
 currently restricted to binomial with 1,2,3-way fixed
 effects."><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">capybara</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/intro.html">Poisson Pseudo-Maximum Likelihood (PPML) Model with Cluster-Robust Standard Errors</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/pachadotdev/capybara/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Asymptotic bias correction after fitting binary choice models with a
 1,2,3-way error component</h1>
    <small class="dont-index">Source: <a href="https://github.com/pachadotdev/capybara/blob/HEAD/R/bias_corr.R" class="external-link"><code>R/bias_corr.R</code></a></small>
    <div class="hidden name"><code>bias_corr.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Post-estimation routine to substantially reduce the incidental
 parameter bias problem. Applies the analytical bias correction derived by
 Fernández-Val and Weidner (2016) and Hinz, Stammann, and Wanner (2020) to
 obtain bias-corrected estimates of the structural parameters and is
 currently restricted to <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></code> with 1,2,3-way fixed
 effects.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bias_corr</span><span class="op">(</span>object <span class="op">=</span> <span class="cn">NULL</span>, L <span class="op">=</span> <span class="fl">0L</span>, panel.structure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"classic"</span>, <span class="st">"network"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>an object of class <code>"feglm"</code>.</p></dd>


<dt>L</dt>
<dd><p>unsigned integer indicating a bandwidth for the estimation of
spectral densities proposed by Hahn and Kuersteiner (2011). The default is
zero, which should be used if all regressors are assumed to be strictly
exogenous with respect to the idiosyncratic error term. In the presence of
weakly exogenous regressors, e.g. lagged outcome variables, we suggest to
choose a bandwidth between one and four. Note that the order of factors to
be partialed out is important for bandwidths larger than zero.</p></dd>


<dt>panel.structure</dt>
<dd><p>a string equal to <code>"classic"</code> or <code>"network"</code>
which determines the structure of the panel used. <code>"classic"</code> denotes
panel structures where for example the same cross-sectional units are
observed several times (this includes pseudo panels). <code>"network"</code>
denotes panel structures where for example bilateral trade flows are
observed for several time periods. Default is <code>"classic"</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A named list of classes <code>"bias_corr"</code> and <code>"feglm"</code>.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Czarnowske, D. and A. Stammann (2020). "Fixed Effects Binary
 Choice Models: Estimation and Inference with Long Panels". ArXiv e-prints.</p>
<p>Fernández-Val, I. and M. Weidner (2016). "Individual and time
 effects in nonlinear panel models with large N, T". Journal of Econometrics,
 192(1), 291-312.</p>
<p>Fernández-Val, I. and M. Weidner (2018). "Fixed effects
 estimation of large-t panel data models". Annual Review of Economics, 10,
 109-138.</p>
<p>Hahn, J. and G. Kuersteiner (2011). "Bias reduction for dynamic
 nonlinear panel models with fixed effects". Econometric Theory, 27(6),
 1152-1191.</p>
<p>Hinz, J., A. Stammann, and J. Wanner (2020). "State Dependence
 and Unobserved Heterogeneity in the Extensive Margin of Trade". ArXiv
 e-prints.</p>
<p>Neyman, J. and E. L. Scott (1948). "Consistent estimates based on
 partially consistent observations". Econometrica, 16(1), 1-32.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="feglm.html">feglm</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">trade_short</span> <span class="op">&lt;-</span> <span class="va">trade_panel</span><span class="op">[</span><span class="va">trade_panel</span><span class="op">$</span><span class="va">year</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">2002L</span><span class="op">:</span><span class="fl">2006L</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">trade_short</span><span class="op">$</span><span class="va">trade</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">trade_short</span><span class="op">$</span><span class="va">trade</span> <span class="op">&gt;</span> <span class="fl">100</span>, <span class="fl">1L</span>, <span class="fl">0L</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit 'feglm()'</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="feglm.html">feglm</a></span><span class="op">(</span><span class="va">trade</span> <span class="op">~</span> <span class="va">lang</span> <span class="op">|</span> <span class="va">year</span>, <span class="va">trade_short</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Apply analytical bias correction</span></span></span>
<span class="r-in"><span><span class="va">mod_bc</span> <span class="op">&lt;-</span> <span class="fu">bias_corr</span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod_bc</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula: trade ~ lang | year</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x5eda7d8eff78&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: Binomial</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |      | Estimate | Std. Error | z value | Pr(&gt;|z|)   |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |------|----------|------------|---------|------------|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> | lang |   0.2393 |     0.0634 |  3.7730 | 0.0002 *** |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Significance codes: *** 99.9%; ** 99%; * 95%; . 90%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: Full 9384; Missing 0; Perfect classification 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Fisher Scoring iterations: 3 </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Mauricio Vargas Sepulveda.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

